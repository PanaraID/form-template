<!DOCTYPE html>
<html>

<head>
  <base target="_top">
</head>

<body>
  <h2>Formulir Input Data</h2>
  <form id="myForm">
    <label for="nama">Nama:</label><br>
    <input type="text" id="nama" name="nama" required><br>
    <label for="email">Email:</label><br>
    <input type="email" id="email" name="email" required><br>
    <label for="pesan">Pesan:</label><br>
    <textarea id="pesan" name="pesan" rows="4" required></textarea><br>
    <input type="submit" value="Submit">
  </form>

  <script>
    // Menangani pengiriman formulir
    document.getElementById("myForm").addEventListener("submit", function (event) {
      event.preventDefault(); // Menghentikan perilaku default submit form

      var formData = {
        nama: document.getElementById("nama").value,
        email: document.getElementById("email").value,
        pesan: document.getElementById("pesan").value
      };

      let formDataToSend = new FormData();
      formDataToSend.append('nama', formData.nama);
      formDataToSend.append('email', formData.email);
      formDataToSend.append('pesan', formData.pesan);
      console.log(formData)

      const url = 'https://script.google.com/macros/s/AKfycby1JotbKEOuN8xS7SPsVQvT-eBtbJpwyeJ4Z02GnYXx1Yros15HUBKBHttX611gjYrE/exec';
      fetch(url, {
        method: "POST",
        body: formDataToSend
      }).then(e => e.json()).then(e => console.log(e))

      // google.script.run.doPost(JSON.stringify(formData)); // Mengirim data ke Google Apps Script

      document.getElementById("myForm").reset(); // Mereset formulir setelah pengiriman data

      alert('Data telah berhasil dikirim!'); // Menampilkan pesan sukses
    });
  </script>
</body>

</html>